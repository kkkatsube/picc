openapi: 3.0.3
info:
  title: PICC API
  description: PICC Learning Project RESTful API
  version: 1.0.0
  contact:
    name: PICC Development Team
    email: dev@picc.local

servers:
  - url: http://localhost:8000/api
    description: Local Development Server
  - url: https://api.picc.dev/api
    description: Staging Server
  - url: https://api.picc.com/api
    description: Production Server

paths:
  /health:
    get:
      summary: API Health Check
      description: システムの稼働状態を確認するヘルスチェックエンドポイント
      operationId: healthCheck
      tags:
        - System
      responses:
        '200':
          description: API is healthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'

  /auth/register:
    post:
      summary: User Registration
      description: 新規ユーザー登録
      operationId: register
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterRequest'
      responses:
        '201':
          description: User registered successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'

  /auth/login:
    post:
      summary: User Login
      description: ユーザーログイン
      operationId: login
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        '200':
          description: Login successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '401':
          description: Invalid credentials
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /auth/logout:
    post:
      summary: User Logout
      description: ユーザーログアウト
      operationId: logout
      tags:
        - Authentication
      security:
        - sanctumAuth: []
      responses:
        '200':
          description: Logout successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MessageResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /auth/user:
    get:
      summary: Get Current User
      description: 認証済みユーザー情報取得
      operationId: getCurrentUser
      tags:
        - Authentication
      security:
        - sanctumAuth: []
      responses:
        '200':
          description: Current user information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /counter:
    get:
      summary: Get User Counter
      description: ユーザーカウンター値取得
      operationId: getUserCounterValue
      tags:
        - Counter
      security:
        - sanctumAuth: []
      responses:
        '200':
          description: Current user counter
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserCounterResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    put:
      summary: Put User Counter
      description: ユーザーカウンター値更新
      operationId: updateUserCounterValue
      tags:
        - Counter
      security:
        - sanctumAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateCounterRequest'
      responses:
        '200':
          description: Updated counter
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserCounterResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /canvases:
    get:
      summary: List User Canvases
      description: ユーザーのキャンバス一覧取得
      operationId: listCanvases
      tags:
        - Canvas
      security:
        - sanctumAuth: []
      responses:
        '200':
          description: List of user canvases
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CanvasListResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    post:
      summary: Create Canvas
      description: 新規キャンバス作成
      operationId: createCanvas
      tags:
        - Canvas
      security:
        - sanctumAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateCanvasRequest'
      responses:
        '201':
          description: Canvas created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CanvasResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'

  /canvases/{id}:
    get:
      summary: Get Canvas
      description: キャンバス詳細取得
      operationId: getCanvas
      tags:
        - Canvas
      security:
        - sanctumAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Canvas details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CanvasResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Canvas not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    put:
      summary: Update Canvas
      description: キャンバス更新
      operationId: updateCanvas
      tags:
        - Canvas
      security:
        - sanctumAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateCanvasRequest'
      responses:
        '200':
          description: Canvas updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CanvasResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Canvas not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
    delete:
      summary: Delete Canvas
      description: キャンバス削除
      operationId: deleteCanvas
      tags:
        - Canvas
      security:
        - sanctumAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Canvas deleted successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MessageResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Canvas not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /canvases/{canvasId}/images:
    get:
      summary: List Canvas Images
      description: キャンバスの画像一覧取得
      operationId: listCanvasImages
      tags:
        - CanvasImage
      security:
        - sanctumAuth: []
      parameters:
        - name: canvasId
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: List of canvas images
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CanvasImageListResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Canvas not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    post:
      summary: Create Canvas Image
      description: キャンバスに画像を追加
      operationId: createCanvasImage
      tags:
        - CanvasImage
      security:
        - sanctumAuth: []
      parameters:
        - name: canvasId
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateCanvasImageRequest'
      responses:
        '201':
          description: Canvas image created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CanvasImageResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Canvas not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'

  /canvases/{canvasId}/images/{id}:
    get:
      summary: Get Canvas Image
      description: キャンバス画像詳細取得
      operationId: getCanvasImage
      tags:
        - CanvasImage
      security:
        - sanctumAuth: []
      parameters:
        - name: canvasId
          in: path
          required: true
          schema:
            type: integer
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Canvas image details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CanvasImageResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Canvas image not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    put:
      summary: Update Canvas Image
      description: キャンバス画像更新
      operationId: updateCanvasImage
      tags:
        - CanvasImage
      security:
        - sanctumAuth: []
      parameters:
        - name: canvasId
          in: path
          required: true
          schema:
            type: integer
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateCanvasImageRequest'
      responses:
        '200':
          description: Canvas image updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CanvasImageResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Canvas image not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
    delete:
      summary: Delete Canvas Image
      description: キャンバス画像削除
      operationId: deleteCanvasImage
      tags:
        - CanvasImage
      security:
        - sanctumAuth: []
      parameters:
        - name: canvasId
          in: path
          required: true
          schema:
            type: integer
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Canvas image deleted successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MessageResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Canvas image not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /favorites/carousels:
    get:
      summary: Get All Favorites Carousels
      description: ユーザーのお気に入りカルーセル一覧取得
      operationId: getFavoritesCarousels
      tags:
        - Favorites
      security:
        - sanctumAuth: []
      responses:
        '200':
          description: Carousels retrieved successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/FavoritesCarousel'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    post:
      summary: Create Favorites Carousel
      description: お気に入りカルーセル作成
      operationId: createFavoritesCarousel
      tags:
        - Favorites
      security:
        - sanctumAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  maxLength: 255
                  example: "背景素材"
              required:
                - name
      responses:
        '201':
          description: Carousel created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FavoritesCarousel'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'

  /favorites/carousels/{id}:
    get:
      summary: Get Favorites Carousel
      description: お気に入りカルーセル詳細取得
      operationId: getFavoritesCarousel
      tags:
        - Favorites
      security:
        - sanctumAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Carousel retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FavoritesCarousel'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Carousel not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    put:
      summary: Update Favorites Carousel
      description: お気に入りカルーセル更新
      operationId: updateFavoritesCarousel
      tags:
        - Favorites
      security:
        - sanctumAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  maxLength: 255
                  example: "背景素材（更新）"
              required:
                - name
      responses:
        '200':
          description: Carousel updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FavoritesCarousel'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Carousel not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
    delete:
      summary: Delete Favorites Carousel
      description: お気に入りカルーセル削除
      operationId: deleteFavoritesCarousel
      tags:
        - Favorites
      security:
        - sanctumAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Carousel deleted successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MessageResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Carousel not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /favorites/carousels/reorder:
    put:
      summary: Reorder Favorites Carousels
      description: お気に入りカルーセルの並び替え
      operationId: reorderFavoritesCarousels
      tags:
        - Favorites
      security:
        - sanctumAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                carousel_ids:
                  type: array
                  items:
                    type: integer
                  example: [3, 1, 2]
              required:
                - carousel_ids
      responses:
        '200':
          description: Carousels reordered successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MessageResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'

  /favorites/carousels/{carouselId}/images:
    get:
      summary: Get Carousel Images
      description: カルーセル内の画像一覧取得
      operationId: getCarouselImages
      tags:
        - Favorites
      security:
        - sanctumAuth: []
      parameters:
        - name: carouselId
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Images retrieved successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/FavoritesImage'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Carousel not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    post:
      summary: Add Image to Carousel
      description: カルーセルに画像追加
      operationId: addImageToCarousel
      tags:
        - Favorites
      security:
        - sanctumAuth: []
      parameters:
        - name: carouselId
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                image_url:
                  type: string
                  format: uri
                  maxLength: 2048
                  example: "http://localhost:4000/images/sample.jpg"
              required:
                - image_url
      responses:
        '201':
          description: Image added successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FavoritesImage'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Carousel not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'

  /favorites/images/{id}:
    delete:
      summary: Delete Favorites Image
      description: お気に入り画像削除
      operationId: deleteFavoritesImage
      tags:
        - Favorites
      security:
        - sanctumAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Image deleted successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MessageResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Image not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /favorites/carousels/{carouselId}/images/reorder:
    put:
      summary: Reorder Carousel Images
      description: カルーセル内画像の並び替え
      operationId: reorderCarouselImages
      tags:
        - Favorites
      security:
        - sanctumAuth: []
      parameters:
        - name: carouselId
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                image_ids:
                  type: array
                  items:
                    type: integer
                  example: [5, 3, 1, 2, 4]
              required:
                - image_ids
      responses:
        '200':
          description: Images reordered successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MessageResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Carousel not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'

components:
  securitySchemes:
    sanctumAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    HealthResponse:
      type: object
      properties:
        status:
          type: string
          enum: [ok, error]
          example: "ok"
        message:
          type: string
          example: "All systems operational"
        timestamp:
          type: string
          format: date-time
          example: "2025-01-09T12:00:00Z"
        version:
          type: string
          example: "1.0.0"
        checks:
          type: object
          properties:
            api:
              $ref: '#/components/schemas/HealthCheck'
            database:
              $ref: '#/components/schemas/HealthCheck'
            redis:
              $ref: '#/components/schemas/HealthCheck'
          required:
            - api
            - database
            - redis
      required:
        - status
        - message
        - timestamp
        - version
        - checks

    HealthCheck:
      type: object
      properties:
        status:
          type: string
          enum: [ok, error]
          example: "ok"
        message:
          type: string
          example: "API is healthy"
        connection_time_ms:
          type: number
          format: float
          example: 7.59
        driver:
          type: string
          example: "pgsql"
        error:
          type: string
          example: "Connection failed"
      required:
        - status
        - message

    RegisterRequest:
      type: object
      properties:
        name:
          type: string
          example: "John Doe"
          minLength: 2
          maxLength: 255
        email:
          type: string
          format: email
          example: "john@example.com"
        password:
          type: string
          format: password
          example: "password123"
          minLength: 8
        password_confirmation:
          type: string
          format: password
          example: "password123"
      required:
        - name
        - email
        - password
        - password_confirmation

    LoginRequest:
      type: object
      properties:
        email:
          type: string
          format: email
          example: "john@example.com"
        password:
          type: string
          format: password
          example: "password123"
      required:
        - email
        - password

    AuthResponse:
      type: object
      properties:
        access_token:
          type: string
          example: "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9..."
        token_type:
          type: string
          example: "Bearer"
        user:
          $ref: '#/components/schemas/User'
      required:
        - access_token
        - token_type
        - user

    User:
      type: object
      properties:
        id:
          type: integer
          example: 1
        name:
          type: string
          example: "John Doe"
        email:
          type: string
          format: email
          example: "john@example.com"
        email_verified_at:
          type: string
          format: date-time
          nullable: true
          example: "2025-01-09T12:00:00Z"
        created_at:
          type: string
          format: date-time
          example: "2025-01-09T12:00:00Z"
        updated_at:
          type: string
          format: date-time
          example: "2025-01-09T12:00:00Z"
      required:
        - id
        - name
        - email
        - created_at
        - updated_at

    UserResponse:
      type: object
      properties:
        data:
          $ref: '#/components/schemas/User'
      required:
        - data

    UpdateCounterRequest:
      type: object
      properties:
        value:
          type: integer
          example: 1
      required:
        - value

    UserCounterResponse:
      type: object
      properties:
        value:
          type: integer
          example: 1
      required:
        - value

    MessageResponse:
      type: object
      properties:
        message:
          type: string
          example: "Operation completed successfully"
      required:
        - message

    ErrorResponse:
      type: object
      properties:
        message:
          type: string
          example: "An error occurred"
        error:
          type: string
          example: "INVALID_CREDENTIALS"
      required:
        - message

    ValidationError:
      type: object
      properties:
        message:
          type: string
          example: "The given data was invalid."
        errors:
          type: object
          additionalProperties:
            type: array
            items:
              type: string
          example:
            email: ["The email field is required."]
            password: ["The password must be at least 8 characters."]
      required:
        - message
        - errors

    Canvas:
      type: object
      properties:
        id:
          type: integer
          example: 1
        user_id:
          type: integer
          example: 1
        name:
          type: string
          nullable: true
          example: "My Canvas"
        memo:
          type: string
          nullable: true
          example: "Canvas description"
        width:
          type: integer
          nullable: true
          example: 1920
        height:
          type: integer
          nullable: true
          example: 1080
        created_at:
          type: string
          format: date-time
          example: "2025-01-09T12:00:00Z"
        updated_at:
          type: string
          format: date-time
          example: "2025-01-09T12:00:00Z"
      required:
        - id
        - user_id
        - created_at
        - updated_at

    CanvasImage:
      type: object
      properties:
        id:
          type: integer
          example: 1
        canvas_id:
          type: integer
          example: 1
        uri:
          type: string
          example: "https://example.com/image.jpg"
        x:
          type: integer
          nullable: true
          example: 100
        y:
          type: integer
          nullable: true
          example: 200
        width:
          type: integer
          nullable: true
          example: 300
        height:
          type: integer
          nullable: true
          example: 400
        left:
          type: integer
          nullable: true
          example: 10
        right:
          type: integer
          nullable: true
          example: 20
        top:
          type: integer
          nullable: true
          example: 30
        bottom:
          type: integer
          nullable: true
          example: 40
        size:
          type: number
          format: float
          nullable: true
          example: 1.5
        created_at:
          type: string
          format: date-time
          example: "2025-01-09T12:00:00Z"
        updated_at:
          type: string
          format: date-time
          example: "2025-01-09T12:00:00Z"
      required:
        - id
        - canvas_id
        - uri
        - created_at
        - updated_at

    CreateCanvasRequest:
      type: object
      properties:
        name:
          type: string
          nullable: true
          example: "My Canvas"
        memo:
          type: string
          nullable: true
          example: "Canvas description"
        width:
          type: integer
          nullable: true
          example: 1920
        height:
          type: integer
          nullable: true
          example: 1080

    UpdateCanvasRequest:
      type: object
      properties:
        name:
          type: string
          nullable: true
          example: "Updated Canvas"
        memo:
          type: string
          nullable: true
          example: "Updated description"
        width:
          type: integer
          nullable: true
          example: 1920
        height:
          type: integer
          nullable: true
          example: 1080

    CreateCanvasImageRequest:
      type: object
      required:
        - add_picture_url
      properties:
        add_picture_url:
          type: string
          format: uri
          pattern: '^https://'
          example: "https://example.com/image.jpg"
          description: HTTPS URL of the image to add (server will fetch dimensions automatically)

    UpdateCanvasImageRequest:
      type: object
      properties:
        uri:
          type: string
          example: "https://example.com/image.jpg"
        x:
          type: integer
          nullable: true
          example: 100
        y:
          type: integer
          nullable: true
          example: 200
        width:
          type: integer
          nullable: true
          example: 300
        height:
          type: integer
          nullable: true
          example: 400
        left:
          type: integer
          nullable: true
          example: 10
        right:
          type: integer
          nullable: true
          example: 20
        top:
          type: integer
          nullable: true
          example: 30
        bottom:
          type: integer
          nullable: true
          example: 40
        size:
          type: number
          format: float
          nullable: true
          example: 1.5

    CanvasResponse:
      type: object
      properties:
        data:
          $ref: '#/components/schemas/Canvas'
      required:
        - data

    CanvasListResponse:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/Canvas'
      required:
        - data

    CanvasImageResponse:
      type: object
      properties:
        data:
          $ref: '#/components/schemas/CanvasImage'
      required:
        - data

    CanvasImageListResponse:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/CanvasImage'
      required:
        - data

    FavoritesCarousel:
      type: object
      properties:
        id:
          type: integer
          example: 1
        user_id:
          type: integer
          example: 1
        name:
          type: string
          example: "背景素材"
        order:
          type: integer
          example: 0
        created_at:
          type: string
          format: date-time
          example: "2025-12-26T00:00:00Z"
        updated_at:
          type: string
          format: date-time
          example: "2025-12-26T00:00:00Z"
        images:
          type: array
          items:
            $ref: '#/components/schemas/FavoritesImage'
      required:
        - id
        - user_id
        - name
        - order
        - created_at
        - updated_at

    FavoritesImage:
      type: object
      properties:
        id:
          type: integer
          example: 1
        carousel_id:
          type: integer
          example: 1
        image_url:
          type: string
          format: uri
          example: "http://localhost:4000/images/sample.jpg"
        order:
          type: integer
          example: 0
        created_at:
          type: string
          format: date-time
          example: "2025-12-26T00:00:00Z"
        updated_at:
          type: string
          format: date-time
          example: "2025-12-26T00:00:00Z"
      required:
        - id
        - carousel_id
        - image_url
        - order
        - created_at
        - updated_at

tags:
  - name: System
    description: システム関連のエンドポイント
  - name: Authentication
    description: 認証関連のエンドポイント
  - name: Counter
    description: カウンター関連のエンドポイント
  - name: Canvas
    description: キャンバス関連のエンドポイント
  - name: CanvasImage
    description: キャンバス画像関連のエンドポイント
  - name: Favorites
    description: お気に入りカルーセル・画像関連のエンドポイント